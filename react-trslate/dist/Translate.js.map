{"version":3,"sources":["../src/Translate.jsx"],"names":["PropTypes","parserCaching","parserCachingMD","LanguageProvider","React","Component","getDerivedStateFromProps","data","active","fallback","getChildContext","lang","name","props","T","interpolation","t","translate","tf","format","_","raw","render","children","childContextTypes","shape","string","func","defaultProps","en","key","args","state","v","arg0","params","length","Object","defaultFormat","withTranslate","assign","contextTypes","process","env","NODE_ENV","displayName"],"mappings":"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","file":"Translate.js","sourcesContent":["//@ts-check\r\nimport React from 'react'\r\nimport * as PropTypes from 'prop-types'\r\nimport { wrapDisplayName } from 'recompose';\r\nimport { isElement } from 'react-is';\r\nimport { translate, parserString, defaultFormat, mdToString, interpolation } from './TranslateUtil'\r\n\r\n\r\nconst parserCaching = {}\r\nconst parserCachingMD = {}\r\n\r\n\r\nexport class LanguageProvider extends React.Component {\r\n\r\n  static childContextTypes = {\r\n    lang: PropTypes.shape({\r\n      name: PropTypes.string,\r\n      T: PropTypes.func,\r\n      t: PropTypes.func,\r\n    }),\r\n  }\r\n\r\n  static defaultProps = {\r\n    data: { en: {} },\r\n    active: \"en\",\r\n    fallback: \"en\",\r\n  }\r\n\r\n  static getDerivedStateFromProps({ data, active, fallback }) {\r\n    return {\r\n      data: data[active],\r\n      fallback: data[fallback]\r\n    }\r\n  }\r\n\r\n  translate = (key, ...args) => {\r\n    let { data, fallback } = this.state\r\n    let v = data[key] || fallback[key] || key\r\n    return translate(\r\n      parserCaching[v] || (parserCaching[v] = parserString(v)),\r\n      ...args\r\n    )\r\n  }\r\n\r\n  raw = (key) => {\r\n    let { data, fallback } = this.state\r\n    let v = data[key] || fallback[key] || key\r\n    return v\r\n  }\r\n\r\n  interpolation = (props) => {\r\n    let { data, fallback } = this.state\r\n    let t = props.t\r\n    let v = data[t] || fallback[t] || t\r\n    return interpolation({\r\n      ...props,\r\n      t: parserCaching[v] || (parserCaching[v] = parserString(v)),\r\n    })\r\n  }\r\n\r\n  format = (t, ...args) => {\r\n    let { data, fallback } = this.state\r\n    let v = data[t] || fallback[t] || t\r\n\r\n    let arg0 = args[0]\r\n    let params = (args.length == 1 && arg0 instanceof Object && !isElement(arg0))\r\n      ? arg0 : args\r\n\r\n    return translate(\r\n      parserCachingMD[v] || (parserCachingMD[v] = parserString(mdToString(v))),\r\n      {\r\n        ...defaultFormat,\r\n        ...params,\r\n      }\r\n    )\r\n  }\r\n\r\n  getChildContext() {\r\n    return {\r\n      lang: {\r\n        name: this.props.active,\r\n        T: this.interpolation,\r\n        t: this.translate,\r\n        tf: this.format,\r\n        _: this.raw,\r\n      }\r\n    };\r\n  }\r\n\r\n\r\n  render() {\r\n    return this.props.children\r\n  }\r\n\r\n}\r\n\r\nexport const withTranslate = function (Component) {\r\n  return Object.assign(\r\n    (props, { lang: { name, t, tf, T, _ } }) => {\r\n      return <Component {...{ lang: name, t, tf, T, _ }}  {...props} />\r\n    },\r\n    {\r\n      contextTypes: LanguageProvider.childContextTypes\r\n    },\r\n    process.env.NODE_ENV !== 'production' ? {\r\n      displayName: wrapDisplayName(Component, 'withTranslate')\r\n    } : {}\r\n  );\r\n}\r\n\r\nexport const T = Object.assign(\r\n  (props, { lang: { name, t, tf, T } }) => {\r\n    return <T {...props} />\r\n  },\r\n  {\r\n    contextTypes: LanguageProvider.childContextTypes\r\n  },\r\n)\r\n\r\n"]}